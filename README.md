# Excelå­—æ®µåˆ†æå·¥å…· - Claude Code Skill

## å¿«é€Ÿå¼€å§‹

### æ–¹æ³•1ï¼šé€šè¿‡Claude Codeå¯¹è¯è°ƒç”¨ï¼ˆæ¨èï¼‰

ç›´æ¥ä¸Claudeå¯¹è¯ï¼š
```
"å¸®æˆ‘åˆ†æè¿™ä¸ªExcelçš„å­—æ®µ"
"åˆ†æ ./data/è½¦é™©æ•°æ®.xlsx çš„å­—æ®µæ˜ å°„"
```

### æ–¹æ³•2ï¼šå‘½ä»¤è¡Œè°ƒç”¨

#### åŸºç¡€åˆ†æï¼ˆæ— äº¤äº’ï¼‰
```bash
python3 ~/.claude/skills/excel-field-analyzer/analyzer.py <Excelæ–‡ä»¶> [è¾“å‡ºç›®å½•] [topn]
```

ç¤ºä¾‹ï¼š
```bash
python3 ~/.claude/skills/excel-field-analyzer/analyzer.py \
    "./2025å¹´ç­¾å•æ¸…å•/å®¶è‡ªè½¦æˆªè‡³11æœˆ13æ—¥.xlsx" \
    "./output" \
    10
```

#### äº¤äº’å¼åˆ†æï¼ˆå¸¦å­—æ®µå­¦ä¹ ï¼‰
```bash
python3 ~/.claude/skills/excel-field-analyzer/interactive_analyzer.py <Excelæ–‡ä»¶> [è¾“å‡ºç›®å½•] [topn]
```

ç¤ºä¾‹ï¼š
```bash
python3 ~/.claude/skills/excel-field-analyzer/interactive_analyzer.py \
    "./data/æ–°æ•°æ®.xlsx" \
    "./analysis_output" \
    20
```

### æ–¹æ³•3ï¼šPython APIè°ƒç”¨

```python
import sys
from pathlib import Path

# æ·»åŠ skillè·¯å¾„
sys.path.append(str(Path.home() / '.claude/skills/excel-field-analyzer'))

from analyzer import ExcelAnalyzer

# åˆ›å»ºåˆ†æå™¨
analyzer = ExcelAnalyzer()

# æ‰§è¡Œåˆ†æ
result = analyzer.analyze_excel(
    xlsx_path='./data/è½¦é™©æ•°æ®.xlsx',
    output_dir='./output',
    topn=10
)

# å¤„ç†ç»“æœ
if result['success']:
    print(f"âœ… åˆ†æå®Œæˆ")
    print(f"HTML: {result['html_path']}")
    print(f"JSON: {result['json_path']}")
    print(f"æœªçŸ¥å­—æ®µ: {', '.join(result['unknown_fields'])}")
else:
    print(f"âŒ {result['message']}")
```

## åŠŸèƒ½è¯´æ˜

### è‡ªåŠ¨è¯†åˆ«çš„å­—æ®µç±»å‹

#### è½¦é™©ä¸šåŠ¡å­—æ®µï¼ˆå·²é¢„ç½®50+æ˜ å°„ï¼‰

**è´¢åŠ¡ç±»**
- ä¿è´¹ç›¸å…³ï¼šå•†ä¸šé™©ä¿è´¹ã€ç­¾å•ä¿è´¹ã€æ‰¹æ”¹ä¿è´¹ã€é€€ä¿ä¿è´¹ã€NCDåŸºå‡†ä¿è´¹
- èµ”æ¬¾ç›¸å…³ï¼šæ€»èµ”æ¬¾ã€æ¡ˆå‡èµ”æ¬¾ã€å‡ºé™©é¢‘åº¦ã€æ¡ˆä»¶æ•°
- è´¹ç”¨ç›¸å…³ï¼šæ€»è´¹ç”¨ã€è´¹ç”¨é‡‘é¢ã€è´¹ç”¨ç‡ã€å˜åŠ¨æˆæœ¬ç‡

**è½¦è¾†ç±»**
- æ–°æ—§è½¦ã€æ˜¯å¦è¿‡æˆ·è½¦ã€æ˜¯å¦æ–°èƒ½æºè½¦
- è½¦é™©åˆ†ç­‰çº§ã€è½¦ç‰Œå½’å±
- å¤§è´§è½¦è¯„åˆ†ã€å°è´§è½¦è¯„åˆ†ã€é«˜é€Ÿé£é™©ç­‰çº§

**æœºæ„ç±»**
- ä¸‰çº§æœºæ„ã€å››çº§æœºæ„

**äº§å“ç±»**
- é™©ç±»ã€é™©ç§ç±»ã€äº¤ä¸‰/ä¸»å…¨
- å•†ä¸šé™©ã€äº¤å¼ºé™©

**æ—¶é—´ç±»**
- ç¡®è®¤æ—¶é—´ã€æŠ•ä¿ç¡®è®¤æ—¶é—´ã€åˆ·æ–°æ—¶é—´ã€ä¿é™©èµ·æœŸ

**å…¶ä»–**
- ä¸šåŠ¡ç±»å‹ã€å®¢æˆ·ç±»åˆ«ã€ç»­ä¿æƒ…å†µã€ç»ˆç«¯æ¥æº

### è¾“å‡ºæ–‡ä»¶

#### 1. HTMLå¯è§†åŒ–æŠ¥å‘Š
åŒ…å«ï¼š
- æ–‡ä»¶ä¿¡æ¯å’Œç”Ÿæˆæ—¶é—´
- æ¯ä¸ªå·¥ä½œè¡¨çš„å®Œæ•´ç»Ÿè®¡è¡¨
- å­—æ®µçš„è¡Œæ•°ã€ç©ºå€¼ã€ç©ºå€¼ç‡ã€å”¯ä¸€å€¼
- æ•°å€¼å­—æ®µçš„ min/max/mean/sum
- Topå€¼åˆ†å¸ƒï¼ˆå¯è‡ªå®šä¹‰æ•°é‡ï¼‰

#### 2. JSONå­—æ®µæ˜ å°„è¡¨
æ ¼å¼ï¼š
```json
[
  {
    "field_name": "commercial_premium",    // è‹±æ–‡å­—æ®µå
    "cn_name": "å•†ä¸šé™©ä¿è´¹",              // ä¸­æ–‡åŸå
    "source_column": "å•†ä¸šé™©ä¿è´¹",         // æºåˆ—å
    "group": "finance",                    // ä¸šåŠ¡åˆ†ç»„
    "dtype": "number",                     // æ•°æ®ç±»å‹
    "role": "measure",                     // è§’è‰²ï¼ˆmeasure/dimensionï¼‰
    "aggregation": "sum",                  // èšåˆæ–¹å¼
    "description": "...",                  // æè¿°
    "notes": "ç©ºå€¼ç‡çº¦ 2.5%",             // å¤‡æ³¨
    "is_mapped": true                      // æ˜¯å¦åœ¨æ˜ å°„åº“ä¸­
  }
]
```

## äº¤äº’å¼å­¦ä¹ ç¤ºä¾‹

å½“é‡åˆ°æœªçŸ¥å­—æ®µæ—¶ï¼š

```
============================================================
ğŸ” å‘ç° 2 ä¸ªæœªçŸ¥å­—æ®µ
============================================================

1. å®¢æˆ·æ»¡æ„åº¦
2. ä»£ç†å•†ç­‰çº§

============================================================
æ˜¯å¦ä¸ºè¿™äº›å­—æ®µåˆ›å»ºæ˜ å°„ï¼Ÿ(y/n): y

å¼€å§‹å­¦ä¹ æ–°å­—æ®µ...

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å­—æ®µ: å®¢æˆ·æ»¡æ„åº¦
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
è‹±æ–‡å­—æ®µå [å»ºè®®: customer_satisfaction]: customer_satisfaction_score

ä¸šåŠ¡åˆ†ç»„é€‰é¡¹:
  1. finance (è´¢åŠ¡æ•°æ®: ä¿è´¹ã€èµ”æ¬¾ã€è´¹ç”¨)
  2. vehicle (è½¦è¾†ç›¸å…³: è½¦ç‰Œã€è½¦å‹)
  3. organization (æœºæ„ä¿¡æ¯: ä¸‰çº§æœºæ„ã€å››çº§æœºæ„)
  4. product (äº§å“ä¿¡æ¯: é™©ç±»ã€é™©ç§)
  5. time (æ—¶é—´æ—¥æœŸ)
  6. flag (æ ‡è¯†å­—æ®µ: æ˜¯å¦...)
  7. partner (åˆä½œä¼™ä¼´: 4Sé›†å›¢)
  8. general (é€šç”¨å­—æ®µ)

é€‰æ‹©åˆ†ç»„ [1-8, é»˜è®¤8]: 8

æ•°æ®ç±»å‹é€‰é¡¹:
  1. number (æ•°å€¼å‹)
  2. string (å­—ç¬¦ä¸²)
  3. datetime (æ—¶é—´æ—¥æœŸ)

é€‰æ‹©ç±»å‹ [1-3, é»˜è®¤2]: 1

è¯´æ˜ï¼ˆå¯é€‰ï¼Œç›´æ¥å›è½¦è·³è¿‡ï¼‰: å®¢æˆ·æ»¡æ„åº¦è¯„åˆ†ï¼ˆ1-5åˆ†ï¼‰

âœ… å·²ä¿å­˜: å®¢æˆ·æ»¡æ„åº¦ â†’ customer_satisfaction_score (general, number)

[ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªå­—æ®µ...]

============================================================
ğŸ”„ ä½¿ç”¨æ–°æ˜ å°„é‡æ–°åˆ†æ...
============================================================
```

## é…ç½®ç®¡ç†

### æŸ¥çœ‹å½“å‰æ˜ å°„åº“

```bash
# æŸ¥çœ‹æ‰€æœ‰æ˜ å°„
python3 -c "
import sys
from pathlib import Path
sys.path.append(str(Path.home() / '.claude/skills/excel-field-analyzer'))
from analyzer import ExcelAnalyzer

analyzer = ExcelAnalyzer()
for cn, mapping in analyzer.mapping_manager.combined_mappings.items():
    print(f'{cn} â†’ {mapping[\"en_name\"]} ({mapping[\"group\"]})')
" | head -20
```

### æ‰‹åŠ¨æ·»åŠ æ˜ å°„

ç¼–è¾‘ `~/.claude/skills/excel-field-analyzer/field_mappings/custom.json`ï¼š

```json
{
  "domain": "custom",
  "mappings": {
    "å®¢æˆ·æ»¡æ„åº¦": {
      "en_name": "customer_satisfaction",
      "group": "general",
      "dtype": "number",
      "description": "å®¢æˆ·æ»¡æ„åº¦è¯„åˆ†"
    }
  }
}
```

### å¯¼å‡ºæ˜ å°„åº“

```bash
# å¤åˆ¶æ˜ å°„æ–‡ä»¶åˆ°å…¶ä»–ç¯å¢ƒ
cp -r ~/.claude/skills/excel-field-analyzer/field_mappings /path/to/backup/
```

## ä¸šåŠ¡åˆ†ç»„è¯´æ˜

| åˆ†ç»„ | è¯´æ˜ | ç¤ºä¾‹ |
|-----|------|------|
| finance | è´¢åŠ¡æ•°æ® | ä¿è´¹ã€èµ”æ¬¾ã€è´¹ç”¨ã€æ¯”ç‡ |
| organization | æœºæ„ä¿¡æ¯ | ä¸‰çº§æœºæ„ã€å››çº§æœºæ„ |
| vehicle | è½¦è¾†ç›¸å…³ | æ–°æ—§è½¦ã€è½¦ç‰Œã€è½¦å‹ |
| product | äº§å“ä¿¡æ¯ | é™©ç±»ã€é™©ç§ |
| time | æ—¶é—´æ—¥æœŸ | ç¡®è®¤æ—¶é—´ã€èµ·æœŸ |
| flag | æ ‡è¯†å­—æ®µ | æ˜¯å¦ç»­ä¿ã€æ˜¯å¦æ–°èƒ½æº |
| partner | åˆä½œä¼™ä¼´ | 4Sé›†å›¢ã€ä»£ç†å•† |
| general | é€šç”¨å­—æ®µ | ä¸šåŠ¡ç±»å‹ã€å®¢æˆ·ç±»åˆ« |

## æ•°æ®ç±»å‹è¯´æ˜

| ç±»å‹ | è§’è‰² | èšåˆæ–¹å¼ | ç¤ºä¾‹ |
|-----|------|---------|------|
| number | measure | sum | ä¿è´¹ã€èµ”æ¬¾ã€è¯„åˆ† |
| datetime | dimension | none | ç¡®è®¤æ—¶é—´ã€èµ·æœŸ |
| string | dimension | none | é™©ç±»ã€å®¢æˆ·ç±»åˆ« |

## å¸¸è§é—®é¢˜

**Q: å¦‚ä½•å¤„ç†æ–°çš„ä¸šåŠ¡é¢†åŸŸï¼Ÿ**
A: åœ¨ `field_mappings/` åˆ›å»ºæ–°çš„JSONæ–‡ä»¶ï¼ˆå¦‚ `logistics.json`ï¼‰ï¼Œå‚è€ƒ `auto_insurance.json` æ ¼å¼ã€‚

**Q: æœªçŸ¥å­—æ®µå¤ªå¤šæ€ä¹ˆåŠï¼Ÿ**
A: ä½¿ç”¨äº¤äº’å¼æ¨¡å¼ `interactive_analyzer.py`ï¼Œé€ä¸ªç¡®è®¤åä¼šè‡ªåŠ¨ä¿å­˜åˆ° `custom.json`ã€‚

**Q: å¦‚ä½•é‡ç½®å­¦ä¹ çš„æ˜ å°„ï¼Ÿ**
A: åˆ é™¤æˆ–æ¸…ç©º `field_mappings/custom.json` çš„ `mappings` éƒ¨åˆ†ã€‚

**Q: æ”¯æŒå¤šä¸ªå·¥ä½œè¡¨å—ï¼Ÿ**
A: æ”¯æŒåˆ†ææ‰€æœ‰å·¥ä½œè¡¨ï¼Œä½†å­—æ®µæ˜ å°„åªé’ˆå¯¹ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨ç”Ÿæˆã€‚

**Q: å¦‚ä½•è‡ªå®šä¹‰Topå€¼æ•°é‡ï¼Ÿ**
A: ä½¿ç”¨ `topn` å‚æ•°ï¼Œå¦‚ `analyzer.py file.xlsx ./output 20`ã€‚

## æµ‹è¯•éªŒè¯

```bash
# æµ‹è¯•åŸºç¡€åŠŸèƒ½
python3 ~/.claude/skills/excel-field-analyzer/analyzer.py \
    "./2025å¹´ç­¾å•æ¸…å•/å®¶è‡ªè½¦æˆªè‡³11æœˆ13æ—¥.xlsx" \
    "./test_output" \
    10

# æ£€æŸ¥è¾“å‡º
ls -lh test_output/
cat test_output/*_å­—æ®µæ˜ å°„.json | head -50
```

## ä¾èµ–å®‰è£…

```bash
pip3 install pandas openpyxl numpy
```

## æ–‡ä»¶ç»“æ„

```
~/.claude/skills/excel-field-analyzer/
â”œâ”€â”€ SKILL.md                    # Skillå®šä¹‰å’Œå®Œæ•´æ–‡æ¡£
â”œâ”€â”€ README.md                   # æœ¬æ–‡ä»¶ï¼ˆå¿«é€ŸæŒ‡å—ï¼‰
â”œâ”€â”€ analyzer.py                 # æ ¸å¿ƒåˆ†æå¼•æ“
â”œâ”€â”€ interactive_analyzer.py     # äº¤äº’å¼wrapper
â”œâ”€â”€ field_mappings/             # å­—æ®µæ˜ å°„åº“
â”‚   â”œâ”€â”€ auto_insurance.json     # è½¦é™©é¢„ç½®æ˜ å°„ï¼ˆ50+å­—æ®µï¼‰
â”‚   â””â”€â”€ custom.json             # ç”¨æˆ·è‡ªå®šä¹‰æ˜ å°„
â””â”€â”€ templates/                  # æœªæ¥æ‰©å±•
```

## ç‰ˆæœ¬å†å²

- v2.0 (2025-11-23) - Claude Code Skillç‰ˆæœ¬ï¼Œæ”¯æŒå¤šæºé…ç½®å’Œäº¤äº’å¼å­¦ä¹ 
- v1.0 - åŸå§‹Webç‰ˆæœ¬

## è®¸å¯è¯

MIT License
